<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Chatbot</title>
    <style>
        /* CSS styles remain unchanged */
    </style>
</head>
<body>
    <div id="chatbox">
        <!-- Chat messages will be displayed here -->
    </div>
    <input type="text" id="userInput" placeholder="Type your message..." onkeypress="handleKeyPress(event)">
    <button onclick="sendMessage()">Send</button>
    <div id="mode-toggle" onclick="toggleDarkMode()">
        <img id="mode-icon" src="light-mode-icon.svg" alt="Light mode icon">
    </div>

    <script>
        let darkMode = false;

        function sendMessage() {
            const userInput = document.getElementById("userInput").value;
            displayUserMessage(userInput);
            document.getElementById("userInput").value = "";

            setTimeout(() => {
                displayTypingIndicator();
                setTimeout(() => {
                    const aiResponse = getAIResponse(userInput);
                    hideTypingIndicator();
                    displayBotMessage(aiResponse);
                }, 1500);
            }, 500);
        }

        function handleKeyPress(event) {
            if (event.keyCode === 13) { // Enter key
                sendMessage();
            }
        }

        function displayUserMessage(message) {
            const messageElement = createMessageElement("You", message, "user-message");
            document.getElementById("chatbox").appendChild(messageElement);
            scrollChatbox();
        }

        function displayBotMessage(message) {
            const messageElement = createMessageElement("Bot", message, "bot-message");
            document.getElementById("chatbox").appendChild(messageElement);
            scrollChatbox();
        }

        function createMessageElement(sender, message, className) {
            const messageElement = document.createElement("div");
            messageElement.classList.add("message");
            messageElement.classList.add(className);
            messageElement.textContent = `${sender}: ${message}`;
            return messageElement;
        }

        function displayTypingIndicator() {
            const typingIndicator = document.createElement("div");
            typingIndicator.classList.add("message");
            typingIndicator.classList.add("bot-message");
            typingIndicator.innerHTML = "Bot: <span class='typing-indicator'><span class='typing-dot'></span><span class='typing-dot'></span><span class='typing-dot'></span></span>";
            document.getElementById("chatbox").appendChild(typingIndicator);
            scrollChatbox();
        }

        function hideTypingIndicator() {
            const typingIndicator = document.querySelector(".typing-indicator");
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function scrollChatbox() {
            document.getElementById("chatbox").scrollTop = document.getElementById("chatbox").scrollHeight;
        }

        function getAIResponse(userInput) {
            switch (true) {
                case userInput.toLowerCase().includes("hi") || userInput.toLowerCase().includes("hello"):
                    return "Hello, how can I assist you?";
                case userInput.toLowerCase().includes("how are you"):
                    return "I'm doing well, thank you for asking!";
                case userInput.match(/what is \d+ [+\-*\/] \d+/):
                    try {
                        const calculation = userInput.match(/(\d+) ([+\-*\/]) (\d+)/);
                        const num1 = parseInt(calculation[1]);
                        const operator = calculation[2];
                        const num2 = parseInt(calculation[3]);
                        let result;
                        switch (operator) {
                            case '+':
                                result = num1 + num2;
                                break;
                            case '-':
                                result = num1 - num2;
                                break;
                            case '*':
                                result = num1 * num2;
                                break;
                            case '/':
                                result = num2 !== 0 ? num1 / num2 : "undefined";
                                break;
                            default:
                                result = "undefined";
                        }
                        return result;
                    } catch (error) {
                        return "Sorry, I couldn't perform the calculation.";
                    }
                default:
                    return "I'm sorry, I didn't understand that.";
            }
        }

        function toggleDarkMode() {
            darkMode = !darkMode;
            const modeIcon = document.getElementById("mode-icon");
            if (darkMode) {
                modeIcon.src = "dark-mode-icon.svg";
                document.body.classList.add("dark-mode");
            } else {
                modeIcon.src = "light-mode-icon.svg";
                document.body.classList.remove("dark-mode");
            }
        }
    </script>
</body>
</html>
